I
shiny::runApp('Desktop/test')
runApp('Desktop/test')
setwd("~/Desktop")
x50 <- read.table(file="tables/bed_intersections_50.txt", header = TRUE, quote = FALSE, as.is = TRUE)
x50 <- read.table(file="tables/bed_intersections_50.txt", header = TRUE, quote = "", as.is = TRUE)
x50 <- read.table(file="tables/bed_intersections_50.txt", header = TRUE, as.is = TRUE)
head(x50)
x50[1,]
x50[1,1:6]
x50[1,1:5]
x50 <- read.table(file="tables/bed_intersections_50.txt", header = TRUE, as.is = TRUE)
x50[1,1:5]
x100 <- read.table(file="tables/bed_intersections_100.txt", header = TRUE, as.is = TRUE)
x100[1,1:5]
x150 <- read.table(file="tables/bed_intersections_150.txt", header = TRUE, as.is = TRUE)
x150[1,1:5]
x200 <- read.table(file="tables/bed_intersections_200.txt", header = TRUE, as.is = TRUE)
x200[1,1:5]
x250 <- read.table(file="tables/bed_intersections_250.txt", header = TRUE, as.is = TRUE)
x250[1,1:5]
x300 <- read.table(file="tables/bed_intersections_300.txt", header = TRUE, as.is = TRUE)
x300[1,1:5]
x350 <- read.table(file="tables/bed_intersections_350.txt", header = TRUE, as.is = TRUE)
x350[1,1:5]
x400 <- read.table(file="tables/bed_intersections_400.txt", header = TRUE, as.is = TRUE)
x400[1,1:5]
x50[1:50,1:5]
x50[1:51,1:5]
all <- cbind(x50[1:50,], x100[51:100,])
all[1:10,1:5]
all[1:100,1:5]
all <- rbind(x50[1:50,], x100[51:100,])
all[1:100,1:5]
all[1:101,1:5]
all <- rbind(x50[1:50,], x100[51:100,], x150[101:150,], x200[151:200,],
x250[201:250,], x300[251:300], x350[301:350], x400[351:400])
all <- rbind(x50[1:50,], x100[51:100,], x150[101:150,], x200[151:200,],
x250[201:250,], x300[251:300,], x350[301:350], x400[351:400])
all <- rbind(x50[1:50,], x100[51:100,], x150[101:150,], x200[151:200,],
x250[201:250,], x300[251:300,], x350[301:350,], x400[351:400,])
all[1:400,1:5]
all[201:400,1:5]
x200[1,1:5]
colnames(x50)
colnames(all) <- colnames(x50)
all[201:400,1:5]
write.table(all, file = "bed_intersections.txt", sep = "\t", row.names = FALSE)
setwd("~/Desktop")
setwd("~/Desktop/tables")
x50 <- read.table(file="tables/bed_intersections_50.txt", header = TRUE, as.is = TRUE)
x50[1,1:5]
x50 <- read.table(file="bed_intersections_50.txt", header = TRUE, as.is = TRUE)
x50[1,1:5]
x100 <- read.table(file="bed_intersections_100.txt", header = TRUE, as.is = TRUE)
x100[1,1:5]
x150 <- read.table(file="bed_intersections_150.txt", header = TRUE, as.is = TRUE)
x150[1,1:5]
x200 <- read.table(file="bed_intersections_200.txt", header = TRUE, as.is = TRUE)
x200[1,1:5]
x250 <- read.table(file="bed_intersections_250.txt", header = TRUE, as.is = TRUE)
x250[1,1:5]
x300 <- read.table(file="bed_intersections_300.txt", header = TRUE, as.is = TRUE)
x300[1,1:5]
x350 <- read.table(file="bed_intersections_350.txt", header = TRUE, as.is = TRUE)
x350[1,1:5]
x400 <- read.table(file="bed_intersections_400.txt", header = TRUE, as.is = TRUE)
x400[1,1:5]
all <- rbind(x50[1:50,], x100[51:100,], x150[101:150,], x200[151:200,],
x250[201:250,], x300[251:300,], x350[301:350,], x400[351:400,])
all[201:400,1:5]
colnames(all) <- colnames(x50)
colnames(all)
fdr.values <- p.adjust(all$p.value, method = "BH")
all$fdr <- fdr.values
write.table(all, file = "bed_intersections.txt", sep = "\t", row.names = FALSE)
shiny::runApp('~/Dropbox/github_repos/BRC1TRANSNET')
runApp('~/Dropbox/github_repos/BRC1TRANSNET')
runApp('~/Dropbox/github_repos/BRC1TRANSNET')
runApp('~/Dropbox/github_repos/BRC1TRANSNET')
runApp('~/Dropbox/github_repos/BRC1TRANSNET')
setwd("~/Dropbox/github_repos/BRC1TRANSNET")
## Load network
network.data <- read.table(file="data/brc1_transcriptional_network.tsv",header = TRUE,as.is=TRUE,sep="\t",comment.char = "")
runApp()
runApp()
runApp()
runApp()
nrow(network.data)
network.data[931,]
runApp()
runApp()
network.data$indegree
brc1net.degree
brc1net.degree <- network.data$indegree + network.data$outdegree
degree.threshold <- quantile(brc1net.degree, prob=0.75)
degree.threshold
top.genes <- gene.names[brc1net.degree > degree.threshold]
gene.names <- network.data$names
gene.names
runApp()
runApp()
runApp()
network.data$description
## Extract gene descriptions
gene.description <- network.data$T.annotation
gene.description
runApp()
runApp()
runApp()
subset(network.data, names %in% intersect.genes)
intersect.genes <- "AT5G61380"
selected.genes.df <- subset(network.data, names %in% intersect.genes)
selected.genes.df
intersect.genes <- "AT5G67060"
selected.genes.df <- subset(network.data, names %in% intersect.genes)
selected.genes.df
# selected.genes.df <- network.data[gene.selection,]
selected.nodes.colors <- selected.genes.df$color
selected.nodes.colors
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
library(VennDiagram)
setwd("~/Dropbox/github_repos/BRC1TRANSNET/analysis/intersections")
## Get description of each AGI symbol
network.data <- read.table(file="../../data/brc1_transcriptional_network.tsv",
as.is = TRUE, header = TRUE, sep="\t", quote = "", comment.char = "")
head(network.data)
description <- network.data$S.annotation
names(description) <- network.data$names
description[1:3]
brc1.network.data <- read.table(file="../../data/brc1_transcriptional_network.tsv",
sep = "\t", as.is = TRUE, header = TRUE, quote = "", comment.char = "")
head(brc1.network.data)
nrow(brc1.network.data)
gene.names <- brc1.network.data$names
length(brc1.targets)
brc1.targets <- gene.names[brc1.network.data$BRC1 == 1]
i <- 1
current.target.genes <- gene.names[brc1.network.data[[i+20]] == 1]
brc1.network.data[[i+20]]
tf.names[i]
######Intersection between BRC1 target genes and all the TFs target genes#########
tf.names <- colnames(brc1.network.data)[21:57]
tf.names[i]
current.target.genes <- gene.names[brc1.network.data[[i+20]] == 1]
intersect.tfs <- intersect(brc1.targets, current.target.genes)
intersect.tfs
library(VennDiagram)
intersect.tfs <- intersect(brc1.targets, current.target.genes)
grid.newpage()
draw.pairwise.venn(area1 = length(brc1.targets),
area2 = length(current.target.genes),
cross.area = length(intersect.tfs),
category = "Hola",
fill=c("mediumseagreen","darkred"),
cat.pos = c(0,190), cat.dist = rep(0.05, 1.3), cat.cex=1.6,
lwd=3,cex=1.4, fontfamily="arial",
cat.fontfamily="arial",fontface="bold",
cat.fontface="bold")
list <- list(brc1.targets, current.target.genes)
grid.newpage()
draw.pairwise.venn(area1 = length(brc1.targets),
area2 = length(current.target.genes),
cross.area = length(intersect.tfs),
category = c("BRC1 targets", "Selected TF targets"),
fill=c("mediumseagreen","darkred"),
cat.pos = c(0,190), cat.dist = rep(0.05, 1.3), cat.cex=1.6,
lwd=3,cex=1.4, fontfamily="arial",
cat.fontfamily="arial",fontface="bold",
cat.fontface="bold")
list <-list(brc1.targets, current.target.genes)
draw.pairwise.venn(list)
draw.pairwise.venn(list, cross.area = intersect(list))
